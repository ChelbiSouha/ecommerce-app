<div class="cart-wrapper" *ngIf="isUserLoggedIn(); else loginMessage">
  <div class="cart-container" *ngIf="items.length; else emptyCart">
    <!-- Title -->
    <h2 class="cart-title">ğŸ›’ Mon Panier</h2>

    <!-- Cart Items -->
    <div class="cart-items">
      <div class="cart-item" *ngFor="let item of items">
        <img [src]="item.product.images[0]" [alt]="item.product.name">
        <div class="details">
          <h3 class="product-name">âœ¨ {{ item.product.name }}</h3>
          <p class="product-desc">{{ item.product.description }}</p>
          <p>Prix unitaire: {{ item.product.price | currency:'TND':'symbol':'1.2-2' }}</p>
          <div class="quantity">
            QuantitÃ©:
            <input type="number" [value]="item.quantity" min="1"
                   (change)="updateQuantity(item.product.id, $event)">
          </div>
          <p>Sous-total: {{ item.product.price * item.quantity | currency:'TND':'symbol':'1.2-2' }}</p>
          <button mat-raised-button color="warn" (click)="removeItem(item.product.id)">
            <mat-icon>delete</mat-icon> Supprimer
          </button>
        </div>
      </div>
    </div>

    <!-- Summary -->
    <div class="cart-summary">
      <p>Sous-total: {{ subtotal | currency:'TND':'symbol':'1.2-2' }}</p>
      <p>Frais de livraison: {{ items.length ? shippingFee : 0 | currency:'TND':'symbol':'1.2-2' }}</p>
      <h3>Total: {{ total | currency:'TND':'symbol':'1.2-2' }}</h3>
      <button mat-raised-button color="primary" (click)="proceedToCheckout()">
        <mat-icon>payment</mat-icon> ProcÃ©der au paiement
      </button>
    </div>
  </div>
</div>

<ng-template #emptyCart>
  <p class="empty-msg">Votre panier est vide ğŸ›ï¸</p>
</ng-template>

<ng-template #loginMessage>
  <p class="empty-msg">Veuillez vous connecter pour voir votre panier ğŸ”’</p>
</ng-template>
